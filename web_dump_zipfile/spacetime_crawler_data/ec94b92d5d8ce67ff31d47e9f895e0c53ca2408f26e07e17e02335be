¦Ifinal_url¡DtypeLhttp_headers¢DtypeEvalue‰¢Ak¢DtypeEvalueSContent-dispositionAv¢DtypeEvalueX#inline; filename="CS274a_HW4soln.m"¢Ak¢DtypeEvaluePContent-EncodingAv¢DtypeEvalueDgzip¢Ak¢DtypeEvalueQTransfer-EncodingAv¢DtypeEvalueGchunked¢Ak¢DtypeEvalueDVaryAv¢DtypeEvalueOAccept-Encoding¢Ak¢DtypeEvalueJKeep-AliveAv¢DtypeEvalueRtimeout=5, max=100¢Ak¢DtypeEvalueFServerAv¢DtypeEvalueVApache/2.4.18 (Ubuntu)¢Ak¢DtypeEvalueJConnectionAv¢DtypeEvalueJKeep-Alive¢Ak¢DtypeEvalueDDateAv¢DtypeEvalueXSun, 03 Feb 2019 17:25:14 GMT¢Ak¢DtypeEvalueLContent-TypeAv¢DtypeEvalueXtext/plain;charset=UTF-8Kraw_content¢DtypeEvalueYL

rand('state',0); randn('state',0);
nRuns = 10000;
Ns=[10 30 100];
ab = {[.1 .4],[4 1],[10 10]};


% Calculate true values first...
for iab = 1:length(ab),
	a=ab{iab}(1); b=ab{iab}(2);
  F(1,iab,1) = a./(a+b); F(2,iab,1) = 0;
  G(1,iab,1) = betacdf(.1,a,b)-betacdf(.05,a,b); G(2,iab,1)=0;
end;

k=1;
for iN = 1:length(Ns),
	N=Ns(iN);
	for iab = 1:length(ab),
		a=ab{iab}(1); b=ab{iab}(2);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Monte Carlo
est = zeros(1,nRuns);
for i=1:nRuns,
	x = betarnd(a,b,1,N);
	fx = x;
	gx = (x>.05)&(x<.1);
	estf(i) = mean(fx);
	estg(i) = mean(gx);
end;
F(1,k,2)=mean(estf); F(2,k,2)=var(estf);  % save estimated bias & variance
G(1,k,2)=mean(estg); G(2,k,2)=var(estg);

%F =
%    0.2014    0.8006    0.4999    0.2000    0.8003    0.5000    0.2000    0.8000    0.5000
%    0.0106    0.0026    0.0012    0.0036    0.0009    0.0004    0.0011    0.0003    0.0001
%
%G =
%    0.0473    0.0001         0    0.0464    0.0001         0    0.0470    0.0001    0.0000
%    0.0045    0.0000         0    0.0015    0.0000         0    0.0004    0.0000    0.0000

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Rejection sampling
est = zeros(1,nRuns);
for i=1:nRuns,
	x=rand(1,N); u=rand(1,N);
	if (a<1 || b<1) estf(i)=NaN; estg(i)=NaN; continue; end;
	mode=(a-1)/(a+b-2);
	keep = (u < 1/ ( mode^(a-1)*(1-mode)^(b-1) ).*(x.^(a-1)*(1-x).^(b-1))); % g(x)/p(x)
	x = x(keep);
	fx = x;
	gx = (x>.05)&(x<.1);
	estf(i) = mean(fx);
	estg(i) = mean(gx);
end;
F(1,k,3)=mean(estf); F(2,k,3)=var(estf);  % save estimated bias & variance
G(1,k,3)=mean(estg); G(2,k,3)=var(estg);

%F(:,:,2) =
%       NaN    0.5002    0.5000       NaN    0.4997    0.4999       NaN    0.4999    0.4998
%       NaN    0.0082    0.0083       NaN    0.0027    0.0028       NaN    0.0009    0.0008
%G(:,:,2) =
%       NaN    0.0498    0.0502       NaN    0.0500    0.0501       NaN    0.0500    0.0500
%       NaN    0.0048    0.0047       NaN    0.0016    0.0016       NaN    0.0005    0.0005

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%IS/SIR
est = zeros(1,nRuns);
for i=1:nRuns,
  x=rand(1,N); w=betapdf(x,a,b);
  fx = x;
  gx = (x>.05)&(x<.1);
  estf(i) = fx*w'/N;
  estg(i) = gx*w'/N;
  estf2(i) = fx*w'/sum(w);
  estg2(i) = gx*w'/sum(w);
end;
F(1,k,4)=mean(estf); F(2,k,4)=var(estf);  % save estimated bias & variance
G(1,k,4)=mean(estg); G(2,k,4)=var(estg);
F(1,k,5)=mean(estf2); F(2,k,5)=var(estf2);
G(1,k,5)=mean(estg2); G(2,k,5)=var(estg2);


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Metropolis
est = zeros(1,nRuns);
T=1000; nChain=1;
for i=1:nRuns,
  x=zeros(1,1000); x(1)=rand;
  for t=1:T,
    x(t)=x(t-1)+randn*sigma;
    Pkeep = (x(t)/x(t-1))^(a-1) * ((1-x(t))/(1-x(t-1)))^(b-1); %betapdf(x(t),a,b)/betapdf(x(t-1),a,b);
    if (x(t)>1 || x(t)<0) Pkeep=0; end;
    if (Pkeep < rand) x(t)=x(t-1); end;
  end;
  x=x(end:-1:end-N+1);
  fx = x;
  gx = (x>.05)&(x<.1);
  estf(i) = mean(fx);
  estg(i) = mean(gx);
end;
F(1,k,6)=mean(estf); F(2,k,6)=var(estf);  % save estimated bias & variance
G(1,k,6)=mean(estg); G(2,k,6)=var(estg);

k=k+1;
end;
end;


Mis_redirected¢DtypeEvalueôIhttp_code¢DtypeEvalueÈQdownload_complete¢DtypeEvalueõ